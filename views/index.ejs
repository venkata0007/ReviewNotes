<%- include('partials/header.ejs') %>
<%if(locals.books){ %>
    <h2>Books</h2>
    <p>Tiny summary but detailed notes for each. Use the ISBN number to find it from your local library or anywhere else. This page will constantly update as I read more, so bookmark it if you want to check back in a few months.</p>
    <p>Sorted with my top recommendations up top. Sort by 
    <a href="/?sortby=title">title</a>,
    <a href="/?sortby=date">newest</a>,
    <a href="/?sortby=rating">best</a>
</p>
    <ul>
        <% for (let book of locals.books) { %>
            <li><a href="/books/<%= book.id %>"><%= book.title %></a></li>
            <img src="<%= book.cover_url %>" alt="<%= book.title %> Cover" style="width: 150px; height: auto;">
            <p>Rating: <%= book.rating %>/5</p>
            <p><%=book.notes%></p> 
            <p><%=book.created_at%></p>
           <% } %>
    </ul>
<% } else { %>
    <p>No books available.</p>
<% } %>

<form action = "/new" method="POST">
    <div >
        <label for="title" class="form-label">Book Title</label>
        <input type="text" class="form-control" id="title" name="title" required>
    </div>
    <div>
        <label for="isbn" class="form-label">ISBN</label>
        <input type="text" class="form-control" id="isbn" name="isbn" required>
    </div>
    <div>
        <label for="notes" class="form-label">Notes</label>
        <textarea class="form-control" id="notes" name="notes" rows="3"></textarea>
    </div>
    <div>
        <label for="rating" class="form-label">Rating</label>
        <input type="number" class="form-control" id="rating" name="rating" min="1" max="5" required>
    </div>
    <button type="submit" class="btn btn-primary">Add Book</button>
</form>

<%- include('partials/footer.ejs') %>